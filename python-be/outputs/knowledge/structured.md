# Structured Data (structured.json)

The `structured.json` file, located in `python-be/outputs/knowledge/`, stores the parsed and structured representations of all Markdown and JSON documents from the `knowledge-base/` directory. This file serves as a cached, easily consumable format for the AI pipeline, eliminating the need to re-parse raw files during every runtime execution.

## Purpose

-   **Efficient Access**: Provides a pre-processed, unified view of all knowledge documents, allowing for quick loading and access by various AI components.
-   **Data Consistency**: Ensures that all knowledge assets are represented in a consistent, structured format (based on the `KnowledgeDocument` model), which simplifies downstream processing and model training.
-   **Offline Availability**: Enables the AI system to operate without direct access to the raw Markdown and JSON files, as all necessary information is cached.

## Structure

The `structured.json` file is a JSON object with two main keys: `"markdown"` and `"json"`. Each key holds a list of `KnowledgeDocument` objects (as defined in `python-be/knowledge_base/models.py`), representing the parsed content of the respective file types.

Each `KnowledgeDocument` object typically includes:

-   **`identifier`**: A unique string identifying the document (e.g., `planning_guidelines.md`).
-   **`title`**: The human-readable title of the document.
-   **`doc_type`**: The type of the document (`"markdown"` or `"json"`).
-   **`path`**: The absolute file path to the original document.
-   **`headings`**: (For Markdown documents) A list of `(heading_text, level)` tuples.
-   **`sections`**: (For Markdown documents) A list of strings, where each string is a content section delimited by headings.
-   **`metadata`**: A dictionary containing any front matter (for Markdown) or other relevant metadata (e.g., content hash for JSON schemas).

Example (simplified):
```json
{
  "markdown": [
    {
      "identifier": "planning_guidelines.md",
      "title": "Planning Guidelines",
      "doc_type": "markdown",
      "path": "d:/Projects/Crownmercado/video-automation/knowledge-base/planning_guidelines.md",
      "headings": [["Narrative Alignment", 2], ["B-Roll Selection", 2]],
      "sections": ["Operational rules...", "Anchor every element...", "Pick b-roll that..."],
      "metadata": {}
    }
  ],
  "json": [
    {
      "identifier": "element_schema.json",
      "title": "Element Schema",
      "doc_type": "json",
      "path": "d:/Projects/Crownmercado/video-automation/knowledge-base/element_schema.json",
      "headings": [],
      "sections": [],
      "metadata": {"hash": "a1b2c3d4..."}
    }
  ]
}
```

## Generation

This file is generated by the `KnowledgeBaseIngestor` (specifically the `persist` method) as part of the `sync_knowledge_base` process. The `KnowledgeBaseIngestor` loads raw Markdown and JSON files, parses them into `KnowledgeDocument` objects, and then serializes these objects into `structured.json`.

## Usage

The `KnowledgeRepository` (from `python-be/knowledge_base/repository.py`) loads this file at runtime to provide immediate access to all structured knowledge documents, which are then used for various operations like semantic search, validation, and graph construction.