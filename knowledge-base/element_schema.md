# Element Schema (element_schema.json)

This document describes the JSON schema used to define the structure and constraints for all timeline elements generated by the AI planning system. This schema is critical for ensuring consistency, validity, and interoperability of the AI's output with the video rendering pipeline.

## Schema Overview

The `element_schema.json` file enforces the following key aspects for each video element:

-   **`timestamp`**: The exact time in seconds from the video's start when the element should appear. Must be a non-negative number.
-   **`duration`**: The length of the element in seconds. Must be a positive number.
-   **`type`**: The family or category of the element (e.g., `broll`, `text_overlay`, `sound_effect`). This field is crucial for determining which other properties are required.
-   **`layer`**: The rendering layer in the compositing stack where the element will be placed (e.g., `main`, `video`, `overlay`, `audio`, `transition`). This ensures proper visual and auditory hierarchy.

## Key Properties and Their Constraints

### Required Fields for All Elements

-   `timestamp` (number): Thời gian xuất hiện của phần tử tính bằng giây kể từ khi video bắt đầu. Phải là số không âm.
-   `type` (string): Định danh loại phần tử (ví dụ: `broll`, `text_overlay`, `sound_effect`).
-   `layer` (string): Lớp hiển thị trong ngăn xếp tổng hợp.

### Optional Fields

-   `duration` (number): Độ dài của phần tử tính bằng giây. Phải là số dương.
-   `description` (string, max 280 characters): Mô tả dễ đọc cho việc lựa chọn tài sản (b-roll/nhấn mạnh).
-   `content` (string or object, max 180 characters for string, max 120 characters for object properties): Nội dung hiển thị trên màn hình hoặc tải trọng có cấu trúc cho các phần tử văn bản.
    -   If string: On-screen copy.
    -   If object: Structured layout for lists or split overlays.
-   `style` (string): Biến thể kiểu văn bản hoặc đồ họa (e.g., `highlighted_background`, `clean_minimal`).
-   `animation` (string): Thiết lập sẵn hoạt ảnh áp dụng cho văn bản hoặc phần tử đồ họa (e.g., `fade_in`, `count_up`).
-   `sound` (string): Định danh tài sản hiệu ứng âm thanh (e.g., `transition_rewind`, `ui_pop`).
-   `action` (string): Hướng dẫn chuyển cảnh hoặc chuyển động cho các hiệu ứng (e.g., `zoom_in`, `fade`).
-   `layer_priority` (integer, 0-5): Ưu tiên lớp tùy chọn cho việc tổng hợp khi nhiều phần tử lớp phủ xếp chồng lên nhau.
-   `confidence` (number, 0-1): Điểm tin cậy của mô hình cho phần tử.
-   `context` (string, max 200 characters): Giải thích ngắn gọn về ý định tường thuật (phản ánh các chú thích JSON).
-   `tags` (array of strings, max 8 items, each max 40 characters, unique): Tập hợp các thẻ ngữ nghĩa tùy chọn được sử dụng để khớp nối.
-   `constraints` (object): Các điều kiện cụ thể của phần tử được thực thi trong quá trình xác thực.

## Type-Specific Requirements (allOf)

The schema uses `allOf` to define conditional requirements based on the `type` of the element:

-   **`broll`**:
    -   Requires `description`.
    -   `layer` must be `video`.
-   **`text_overlay`, `text_animation`, `icon`, `section_header`, `emphasis`**:
    -   Requires `content`.
    -   `layer` must be `overlay`.
-   **`sound_effect`**:
    -   Requires `sound`.
    -   `layer` must be `audio`.
-   **`effect`**:
    -   Requires `action` and `duration`.
    -   `layer` must be `transition`.
-   **`speaker_intro`, `achievement_highlight`**:
    -   `layer` must be `main`.

This schema ensures that all AI-generated video plan elements adhere to a strict, well-defined structure, facilitating robust validation and seamless integration into the video production workflow.